---
title: "Data science and analysis in Neuroscience"
author: "Kevin Allen"
date: "November 21, 2019"
output:
  ioslides_presentation: default
  slidy_presentation: default
  beamer_presentation: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
```


## Today's plan

1. Review exercises (15 minutes)
2. RStudio editor and .R files. (10 minutes)
3. git repositories (15 minutes)
4. Introduction to ggplot2 (30 minutes)
5. Introduction to dplyr (30 minutes)
6. Example: Analysis of behavioral data (30 minutes)

## RStudio editor

A place to store the code you care about.

Save code into a .R file for later use or sharing.

```{r, echo=FALSE,out.width = "500px"}
knitr::include_graphics("images/rstudio-editor.png")
```

## RStudio editor

1. Open a new R script (File/New File/R script).
2. Execute a single expression: Cmd/Ctrl-Enter
3. Execute the entire script: Cmd?Ctrl-Shift-S
4. Don't inlcude install.packages() or setwd() in your script.

See live example!

## An introduction to ggplot2

1. `ggplot2` is an R package for visualization.
2. It is relatively easy to learn.
3. You get nice looking graphs relatively quickly.
4. It works well with data frames.
5. R also has base graphics, `plot()`

## Create a plot

```{r plot}
ggplot(data=mpg) +
  geom_point(mapping = aes(x = displ, y = hwy))
```

## Template

```{r plot1, eval=FALSE}
ggplot(data=<DATA>) +
  <GEOM_FUNCTION>(mapping = aes(<MAPPINGS>))
```

1. `ggplot` creates an empty graph and coordinate system for the data
2. `geom` functions add layers to the plot
3. `geom` functions need a mapping argument paired with `aes()`

## Aesthetic Mapping

Aesthetics include the x-axis and y-axis, together with size, shape, color of the points.

```{r plot2,out.width=500}
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy, color = class))
```

Shape and color work better with categorical variables.

## Exercise with ggplot2

1. What plot could you produce to investigate whether cars are more efficient on the highway or in a city?
2. How could you add information about the displacement of the motor in your graph? 

## Solution

```{r plot3,out.width=500}
ggplot(data = mpg) +
  geom_point(mapping = aes(x = hwy, y = cty, size=displ),
             color = "blue")+
  xlim(5,40) +
  ylim(5,40)
```

Here I set an aesthetic manually, outside of the `mapping = aes()` block.

## Facets

Split your plot into facets

```{r plot4, out.width=500}
ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_wrap(~class, nrow = 2)
```

## Geometric objects

Show different types of graphs

There are up to 30 types of geoms. 

You can mix geoms.

## Geometric objects

geom_smooth

```{r geom_smooth,out.width=500}
ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy))
```

## Geometric objects

geom_smooth

```{r geom_smooth0,out.width=500}
ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy, linetype = drv))
```

## Geometric object 

Combining several geoms

```{r geom_smooth1,out.width=400}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point() +
  geom_smooth()
```

## Count and distributions

Categorical variable
```{r count,out.width=500}
ggplot(data = mpg) +
  geom_bar(mapping = aes(x=class))
```

## Count and distribution
Continuous variable
```{r count1,out.width=500}
ggplot(data = mpg) +
  geom_histogram(mapping = aes(x=displ))
```

## Exercise 

1. Produce a boxplot showing the highway consumption for the different classes of cars.

## Solution

```{r boxplot, out.width=500}
ggplot(data = mpg) +
  geom_boxplot(mapping = aes(x=class,y=hwy))
```








## tidyverse

`tidyverse` is a collection of R packages for data science.

Advantages of tidyverse over built-in core R functions

1. Code is easier to understand 
2. Code is easier to read 
3. Easier to learn

Disadvantage

1. You need to load it before starting coding
2. You need tidy data frames

## tidyverse

```{r tidy1, results = 'hide'}
library(tidyverse)
```

## Data transformation with dplyr


## Exercise with dplyr



## Next lecture


## For the next lecture

